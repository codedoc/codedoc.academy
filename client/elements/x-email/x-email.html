<link rel="import" href="../../components/core-ajax/core-ajax.html">
<link rel="import" href="../../components/core-input/core-input.html">

<polymer-element name="x-email" attributes="endpoint method ping-type" extends="core-input">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <shadow></shadow>
    <core-ajax
      id="request"
      method="{{ method || 'POST' }}"
      url="{{ endpoint }}"
      handleAs="json"
      on-core-response="{{handleResponse}}">
    </core-ajax>
  </template>
  <script>
    Polymer('x-email', {
      
      type: 'email',

      send: function () {
        var email = this;
        var request = this.$.request;
        var data = {
          email: email.value,
          type: email['ping-type']
        };

        if (email.validity.valid) {
          console.log(data);
          console.log(this.endpoint);

          request.params = JSON.stringify(data);
          request.go();
          console.log('done!');
        } else {
          console.error('There was an error');
        }
      }

    });
  </script>
</polymer-element>
